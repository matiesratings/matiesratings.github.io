<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Knockout Bracket</title>
<style>
  body {
    background: #111;
    color: white;
    font-family: Arial, sans-serif;
    overflow: auto; /* allow scrolling */
  }
  .bracket {
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    padding: 50px;
    gap: 100px; /* space between columns */
  }
    .round {
    display: flex;
    flex-direction: column;
    position: relative;
    gap: 0; /* we'll calculate spacing dynamically */
    }

  .match {
    background: #222;
    border: 2px solid maroon;
    border-radius: 6px;
    padding: 6px 12px;
    text-align: left;
    min-width: 120px;
    position: relative;
  }
  .player {
    display: flex;
    justify-content: space-between;
    margin: 2px 0;
  }
  .score {
    margin-left: 10px;
    color: #aaa;
  }
  svg {
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
    width: 100%;
    height: 100%;
    overflow: visible;
  }
</style>
</head>
<body>
<div id="bracket-wrapper" style="width: 100%; overflow-x: auto; overflow-y: hidden;position: relative;">
  <div class="bracket" id="bracket" style="position: relative; min-width: 3000px;">
    <!-- Your rounds & SVG here -->
  <!-- <svg id="lines"></svg> -->
<svg id='lines' style='position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;'></svg>

  </div>
</div>


<script>

const wrapper = document.getElementById("bracket-wrapper");

// Scroll the viewport horizontally to center
wrapper.scrollLeft = (wrapper.scrollWidth - wrapper.clientWidth) / 2;
// Example knockout data
const knockout = {
  "left": [
    [
      ["Player 1", "Player 2"], ["Player 3", "Player 4"], ["Player 5", "Player 6"], ["Player 7", "Player 8"],
      ["Player 9", "Player 10"], ["Player 11", "Player 12"], ["Player 13", "Player 14"], ["Player 15", "Player 16"],
      ["Player 17", "Player 18"], ["Player 19", "Player 20"], ["Player 21", "Player 22"], ["Player 23", "Player 24"],
      ["Player 25", "Player 26"], ["Player 27", "Player 28"], ["Player 29", "Player 30"], ["Player 31", "Player 32"]
    ],
    [
      ["Player 1", "Player 2"], ["Player 3", "Player 4"], ["Player 5", "Player 6"], ["Player 7", "Player 8"],
      ["Player 9", "Player 10"], ["Player 11", "Player 12"], ["Player 13", "Player 14"], ["Player 15", "Player 16"]
    ],
    [
      ["Player 1", "Player 2"], ["Player 3", "Player 4"],
      ["Player 5", "Player 6"], ["Player 7", "Player 8"]
    ],
    [
      ["Player 1", "Player 2"], ["Player 3", "Player 4"]
    ],
    [
      ["Player 1", "Player 2"]
    ]
  ],
  "right": [
    [
      ["Player 65", "Player 66"], ["Player 67", "Player 68"], ["Player 69", "Player 70"], ["Player 71", "Player 72"],
      ["Player 73", "Player 74"], ["Player 75", "Player 76"], ["Player 77", "Player 78"], ["Player 79", "Player 80"],
      ["Player 81", "Player 82"], ["Player 83", "Player 84"], ["Player 85", "Player 86"], ["Player 87", "Player 88"],
      ["Player 89", "Player 90"], ["Player 91", "Player 92"], ["Player 93", "Player 94"], ["Player 95", "Player 96"]
    ],
    [
      ["Player 65", "Player 66"], ["Player 67", "Player 68"], ["Player 69", "Player 70"], ["Player 71", "Player 72"],
      ["Player 73", "Player 74"], ["Player 75", "Player 76"], ["Player 77", "Player 78"], ["Player 79", "Player 80"]
    ],
    [
      ["Player 65", "Player 66"], ["Player 67", "Player 68"],
      ["Player 69", "Player 70"], ["Player 71", "Player 72"]
    ],
    [
      ["Player 65", "Player 66"], ["Player 67", "Player 68"]
    ],
    [
      ["Player 65", "Player 66"]
    ]
  ],
  "final": [
    ["Player 1", "Player 65"]
  ]
}


const bracket = document.getElementById("bracket");
const svg = document.getElementById("lines");

// Create rounds for left side
knockout.left.forEach((round, r) => {
  const col = document.createElement("div");
  col.className = "round";
  round.forEach(match => {
    col.appendChild(makeMatch(match));
  });
  bracket.insertBefore(col, svg);
});

// Final in middle
const finalCol = document.createElement("div");
finalCol.className = "round";
knockout.final.forEach(match => {
  const final = makeMatch(match);
  final.classList.add("final");
  finalCol.appendChild(final);
});
bracket.appendChild(finalCol);

// Create rounds for right side (reverse order so closest round is next to final)
knockout.right.slice().reverse().forEach((round, r) => {
  const col = document.createElement("div");
  col.className = "round";
  round.forEach(match => {
    col.appendChild(makeMatch(match));
  });
  bracket.appendChild(col);
});


// Helper: build a match div
function makeMatch(players) {
  const div = document.createElement("div");
  div.className = "match";
  players.forEach(p => {
    const row = document.createElement("div");
    row.className = "player";
    const name = document.createElement("span");
    name.textContent = p;
    const score = document.createElement("span");
    score.className = "score";
    score.textContent = ""; // fill later if match played
    row.appendChild(name);
    row.appendChild(score);
    div.appendChild(row);
  });
  return div;
}

// Draw SVG connectors
function drawLines() {
  svg.innerHTML = "";
  const rounds = [...document.querySelectorAll(".round")];
  const finalIndex = Math.floor(rounds.length / 2); // where the finals are

  for (let i = 0; i < rounds.length - 1; i++) {
    const matchesA = rounds[i].querySelectorAll(".match");
    const matchesB = rounds[i + 1].querySelectorAll(".match");

    // --- LEFT SIDE (before finals) ---
    if (i < finalIndex) {
      matchesA.forEach((m, j) => {
        const target = matchesB[Math.floor(j / 2)];
        if (target) connectLeft(m, target);
      });
    }

    // --- RIGHT SIDE (after finals) ---
    else if (i >= finalIndex) {
      matchesB.forEach((m, j) => {
        const target = matchesA[Math.floor(j / 2)];
        if (target) connectRight(m, target);
      });
    }
  }
}
// Connect left half: curves to the right
function connectLeft(a, b) {
  const bracketRect = bracket.getBoundingClientRect();
  const aRect = a.getBoundingClientRect();
  const bRect = b.getBoundingClientRect();

  const x1 = aRect.right - bracketRect.left;
  const y1 = aRect.top - bracketRect.top + aRect.height / 2;
  const x2 = bRect.left - bracketRect.left;
  const y2 = bRect.top - bracketRect.top + bRect.height / 2;

  const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
  path.setAttribute("d", `M${x1},${y1} C${(x1+x2)/2},${y1} ${(x1+x2)/2},${y2} ${x2},${y2}`);
  path.setAttribute("stroke", "white");
  path.setAttribute("fill", "none");
  path.setAttribute("stroke-width", "2");
  svg.appendChild(path);
}

function connectRight(a, b) {
  const bracketRect = bracket.getBoundingClientRect();
  const aRect = a.getBoundingClientRect();
  const bRect = b.getBoundingClientRect();

  const x1 = aRect.left - bracketRect.left;
  const y1 = aRect.top - bracketRect.top + aRect.height / 2;
  const x2 = bRect.right - bracketRect.left;
  const y2 = bRect.top - bracketRect.top + bRect.height / 2;

  const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
  path.setAttribute("d", `M${x1},${y1} C${(x1+x2)/2},${y1} ${(x1+x2)/2},${y2} ${x2},${y2}`);
  path.setAttribute("stroke", "white");
  path.setAttribute("fill", "none");
  path.setAttribute("stroke-width", "2");
  svg.appendChild(path);
}

// Redraw after layout
window.addEventListener("load", drawLines);
window.addEventListener("resize", drawLines);


</script>

</body>
</html>
